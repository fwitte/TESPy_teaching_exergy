

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>ORC Combined Heat and Power &#8212; Teaching Exergy using TESPy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'processes/orc-combined-heat-and-power';</script>
    <link rel="shortcut icon" href="../_static/logo_tespy_small.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="List of Abbreveations" href="../abbreveations-symbols.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_tespy_mid.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo_tespy_mid.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting-started/setup-python.html">Setup your Python environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/intro-packages.html">Introduction to used libraries</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro/scope-and-preconditions.html">Goals and Scope of the Course</a></li>

<li class="toctree-l1"><a class="reference internal" href="../intro/exergy-analysis.html">Fundamentals of Exergy Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Single Components</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../single-components/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../single-components/adiabatic-pipe-flow.html">Adiabatic Pipe Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../single-components/heat-exchanger.html">Heat Exchanger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../single-components/compressed-air.html">Compressed Air Production</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermodynamic Cycles</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cycles/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cycles/open-gas-turbine.html">Gas Turbine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cycles/clausius-rankine.html">Clausius Rankine Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cycles/heat-pump.html">Heat Pump</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Complex Processes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">ORC Combined Heat and Power</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../abbreveations-symbols.html">List of Abbreveations</a></li>

<li class="toctree-l1"><a class="reference internal" href="../zliterature.html">Literature References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/fwitte/TESPy_teaching_exergy" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/fwitte/TESPy_teaching_exergy/issues/new?title=Issue%20on%20page%20%2Fprocesses/orc-combined-heat-and-power.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/processes/orc-combined-heat-and-power.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ORC Combined Heat and Power</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-solution-1">Proposed solution 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-solution-1-1">Proposed solution 1.1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geothermal-combined-heat-and-power-plant">Geothermal combined heat and power plant</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-solution-1-2">Proposed solution 1.2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geothermal-plant-with-only-power-generation">Geothermal plant with only power generation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-solution-1-3">Proposed solution 1.3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lessons-learned">Lessons Learned</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="orc-combined-heat-and-power">
<span id="orc-chp-label"></span><h1>ORC Combined Heat and Power<a class="headerlink" href="#orc-combined-heat-and-power" title="Permalink to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Subject of the following example of a more complex thermodynamic process will be a combined geothermal heat and power plant. As even deep geothermal boreholes can not supply temperatures high enough to drice conventional powerplant processes, such as the aforementioned and thoroughly analyzed Clausius Rankine Cycle, adjustments are necessary. Organic process fluids whose vaporization temperature is lower than that of water allow the execution of a Rankine cycle at these lower heat source temperatures, resulting in the so called <em>Organic Rankine Cycle</em>.</p>
<p>The following exercises are supposed to emulate a typical energy engineers workflow. The task is a process design study, where conditions of the surrundings and requirements of stakeholders are given. The proposed process design has to fulfill these constraints, which are displayed in <a class="reference internal" href="#geothermal-chp-parameters"><span class="std std-numref">Fig. 21</span></a>.</p>
<figure class="align-default" id="geothermal-chp-parameters">
<img alt="../_images/geothermal_chp_parameters.png" src="../_images/geothermal_chp_parameters.png" />
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">Boundary conditions of the geothermal plant with cogeneration of heat and power.</span><a class="headerlink" href="#geothermal-chp-parameters" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Additionally, <a class="reference internal" href="#comp-approx"><span class="std std-numref">Table 5</span></a> lists approximations of typical component parameters.</p>
<table class="table" id="comp-approx">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Approximations of typical component parameters</span><a class="headerlink" href="#comp-approx" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Parameter</p></th>
<th class="head"></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Auxillary Installations</p></td>
<td><p>Electrical power requirements</p></td>
<td></td>
<td><p>3</p></td>
<td><p>MW</p></td>
</tr>
<tr class="row-odd"><td><p>Generators</p></td>
<td><p>Mechanical-electrical efficiency</p></td>
<td></td>
<td><p>0.985</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Motors</p></td>
<td><p>Electrical-mechanical efficiency</p></td>
<td></td>
<td><p>0.975</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Steam turbines</p></td>
<td><p>Isentropic efficiency</p></td>
<td></td>
<td><p>0.9</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Mechanical efficiency</p></td>
<td></td>
<td><p>0.99</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Minimum steam quality</p></td>
<td></td>
<td><p>0.9</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Pumps</p></td>
<td><p>Isentropic efficiency</p></td>
<td></td>
<td><p>0.8</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Mechanical efficiency</p></td>
<td></td>
<td><p>0.99</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Heat Exchangers</p></td>
<td><p>Minimal temperature difference</p></td>
<td><p>liquid-liquid</p></td>
<td><p>10</p></td>
<td><p>K</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>liquid-condensing</p></td>
<td><p>5</p></td>
<td><p>K</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>liquid-steam</p></td>
<td><p>20</p></td>
<td><p>K</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>liquid-gaseous</p></td>
<td><p>25</p></td>
<td><p>K</p></td>
</tr>
</tbody>
</table>
<p>The proposed process is to be evaluated both with an energy- and an exergy-based approach. This can be achieved via efficiency values, which put the benefit of the process in relation to the necessary input. The energy efficiency of the cobined heat and power process is defined according to Eq. <a class="reference internal" href="#equation-orc-chp-energy-efficiency">(41)</a> and the exergy efficiency according to Eq. <a class="reference internal" href="#equation-orc-chp-exergy-efficiency">(42)</a>.</p>
<div class="math notranslate nohighlight" id="equation-orc-chp-energy-efficiency">
<span class="eqno">(41)<a class="headerlink" href="#equation-orc-chp-energy-efficiency" title="Permalink to this equation">#</a></span>\[    \eta_{CHP} = \frac{\dot{W}_{net} + \dot{Q}_{DH}}{\dot{H}_1 - \dot{H}_2}\]</div>
<div class="math notranslate nohighlight" id="equation-orc-chp-exergy-efficiency">
<span class="eqno">(42)<a class="headerlink" href="#equation-orc-chp-exergy-efficiency" title="Permalink to this equation">#</a></span>\[    \epsilon_{CHP} = \frac{\dot{W}_{net} + (\dot{E}_{ff} - \dot{E}_{bf})}{\dot{E}_1 - \dot{E}_2}\]</div>
</section>
<section id="exercise-1">
<h2>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Build a geothermal combined heat and power plant according to the boundary conditions in <a class="reference internal" href="#geothermal-chp-parameters"><span class="std std-numref">Fig. 21</span></a> and <a class="reference internal" href="#comp-approx"><span class="std std-numref">Table 5</span></a>.</p></li>
<li><p>Build another geothermal plant based on the one before that replaces the heat output with another cycle extracting electrical power.</p></li>
<li><p>Evaluate both processes according to Eqs. <a class="reference internal" href="#equation-orc-chp-energy-efficiency">(41)</a> and <a class="reference internal" href="#equation-orc-chp-exergy-efficiency">(42)</a> and compare each other.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This task is described very openly, so there is no single right solution. You have to be creative to find a working process that fulfills all requirements.</p>
<p>At first, you can try to come up with components that are necessary to supply the desired outputs. You can build simple cycles and contemplate how they can be improved.</p>
<p>Additionally, you can get inspiration through existing plants as described in the literature. A few examples are <span id="id1">DiPippo [<a class="reference internal" href="../zliterature.html#id10" title="Ronald DiPippo. Geothermal Power Plants. Elsevier, 2015. doi:10.1016/C2014-0-02885-7.">5</a>]</span>, <span id="id2">Drbal <em>et al.</em> [<a class="reference internal" href="../zliterature.html#id11" title="Lawrence F. Drbal, Patricia G. Boston, and Kayla L. Westra. Power Plant Engineering. Springer, 1996. doi:10.1007/978-1-4613-0427-2.">6</a>]</span>, <span id="id3">Kitto and Stultz [<a class="reference internal" href="../zliterature.html#id12" title="J. B. Kitto and S. C. Stultz. Steam: Its Generation and Use. Babcock &amp; Wilcoy Company, 2005.">7</a>]</span> and <span id="id4">Strauss [<a class="reference internal" href="../zliterature.html#id13" title="Karl Strauss. Kraftwerkstechnik. Springer, 2016. doi:10.1007/978-3-662-53030-6.">8</a>]</span> (german).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Your model very likely will be quite complex and use a lot of components which need parametrization. Building the whole model at once likely results in too few or too many parameters, which can be hard to track down. Oftentimes, a better approach is to build parts of the model, e.g. inner cycles or outer strands, and make them work. Only then the parts are joined together to build the whole process.</p>
<p>Also, you will probably encouter issues when setting terminal temperature differences without stable starting values. As mentioned in other examples, running the model with best-guess starting values before finalizing parametrization strengthens stability and can even be necessary. Besides the other examples, you are referred to the TESPy tutorial on <a href="https://tespy.readthedocs.io/en/dev/tutorials/starting_values.html#tespy-tutorial-starting-values-label">How to Generate Stable Starting Values</a>.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Proposed process designs (only use if necessary!)</p>
<p>If you are having trouble creating/finding a suitable process design that fulfills all the requirements, example designs are provided here. Definitly try to come up with your own process designs at first, as there is a lot to learn trying, failing and hopefully finally succeeding in solving the tasks.</p>
<p>For the cogeneration of heat and power, an ORC using the liquid phase from the geothermal source will be employed to solely supply power. The gaseous mass fraction can be fed directly through a steam turbine and condensated to supply the district heating network with heat. The process diagram of the described CHP plant can be found in <a class="reference internal" href="#orc-chp-flowsheet"><span class="std std-numref">Fig. 22</span></a>. The heat outflow to close the Organic Rankine Cycle is realized through cooling with ambient air. Finally, the two streams from the geothermal source are combined again to be fed back into the geothermal sink.</p>
<figure class="align-default" id="orc-chp-flowsheet">
<img alt="../_images/geothermal_orc_chp.svg" src="../_images/geothermal_orc_chp.svg" /><figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Flow sheet of the geothermal plant with cogeneration of heat and power.</span><a class="headerlink" href="#orc-chp-flowsheet" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The second approach without the supply of heat is implemented with an additional Organic Rankinke Cycle replacing the district heating condenser. This second ORC is in principle of the same structure as the first one, as can be seen in <a class="reference internal" href="#orc-full-elec-flowsheet"><span class="std std-numref">Fig. 23</span></a>.</p>
<figure class="align-default" id="orc-full-elec-flowsheet">
<img alt="../_images/geothermal_orc_full_elec.svg" src="../_images/geothermal_orc_full_elec.svg" /><figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">Flow sheet of the geothermal plant with sole power generation.</span><a class="headerlink" href="#orc-full-elec-flowsheet" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</section>
<section id="proposed-solution-1">
<span id="orc-proposed-solution-1-label"></span><h2>Proposed solution 1<a class="headerlink" href="#proposed-solution-1" title="Permalink to this heading">#</a></h2>
<p><strong>First Step</strong>: Build the ORC as basis for geothermal combined heat and power plant and geothermal power plant</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tespy.networks</span> <span class="kn">import</span> <span class="n">Network</span>
<span class="kn">from</span> <span class="nn">tespy.connections</span> <span class="kn">import</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">Bus</span>
<span class="kn">from</span> <span class="nn">tespy.components</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CycleCloser</span><span class="p">,</span> <span class="n">Source</span><span class="p">,</span> <span class="n">Sink</span><span class="p">,</span> <span class="n">Pump</span><span class="p">,</span> <span class="n">Turbine</span><span class="p">,</span> <span class="n">HeatExchanger</span><span class="p">,</span><span class="n">HeatExchangerSimple</span><span class="p">,</span>
    <span class="n">Condenser</span><span class="p">,</span> <span class="n">Drum</span><span class="p">,</span> <span class="n">DropletSeparator</span><span class="p">,</span> <span class="n">Merge</span>
    <span class="p">)</span>

<span class="c1"># Network</span>
<span class="n">nw</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">fluids</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">])</span>
<span class="n">nw</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T_unit</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">p_unit</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">h_unit</span><span class="o">=</span><span class="s1">&#39;kJ / kg&#39;</span><span class="p">)</span>

<span class="n">flu_vec_orc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">flu_vec_water</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">flu_vec_air</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="c1"># Components</span>
<span class="c1"># ORC</span>
<span class="n">orc_cc</span> <span class="o">=</span> <span class="n">CycleCloser</span><span class="p">(</span><span class="s1">&#39;ORC Cycle Closer&#39;</span><span class="p">)</span>
<span class="n">orc_preheater</span> <span class="o">=</span> <span class="n">HeatExchanger</span><span class="p">(</span><span class="s1">&#39;ORC Preheater&#39;</span><span class="p">)</span>
<span class="n">orc_drum</span> <span class="o">=</span> <span class="n">Drum</span><span class="p">(</span><span class="s1">&#39;ORC Drum&#39;</span><span class="p">)</span>
<span class="n">orc_evaporator</span> <span class="o">=</span> <span class="n">HeatExchanger</span><span class="p">(</span><span class="s1">&#39;ORC Evaporator&#39;</span><span class="p">)</span>
<span class="n">orc_turbine</span> <span class="o">=</span> <span class="n">Turbine</span><span class="p">(</span><span class="s1">&#39;ORC Turbine&#39;</span><span class="p">)</span>
<span class="n">orc_condenser</span> <span class="o">=</span> <span class="n">Condenser</span><span class="p">(</span><span class="s1">&#39;ORC Condenser&#39;</span><span class="p">)</span>
<span class="n">orc_pump</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="s1">&#39;ORC Pump&#39;</span><span class="p">)</span>

<span class="c1"># Condenser coolant cycle</span>
<span class="n">cool_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;Coolant Source&#39;</span><span class="p">)</span>
<span class="n">cool_sink</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;Coolant Sink&#39;</span><span class="p">)</span>

<span class="c1"># Auxiliary source and sink</span>
<span class="n">liquid_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;Liquid Sep Source&#39;</span><span class="p">)</span>
<span class="n">geo_pump</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="s1">&#39;Geothermal Pump&#39;</span><span class="p">)</span>
<span class="n">geo_sink1</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;Geothermal Sink1&#39;</span><span class="p">)</span>

<span class="c1"># Connections</span>
<span class="c1"># ORC</span>
<span class="n">orc_pump2orc_cc</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_cc</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;30&#39;</span><span class="p">)</span>
<span class="n">orc_cc2orc_preheater</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_cc</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;31&#39;</span><span class="p">)</span>
<span class="n">orc_preheat2orc_drum</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">orc_drum</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;32&#39;</span><span class="p">)</span>
<span class="n">orc_drum2orc_eva</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_drum</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;33&#39;</span><span class="p">)</span>
<span class="n">orc_eva2orc_drum</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">orc_drum</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;34&#39;</span><span class="p">)</span>
<span class="n">orc_drum2orc_turb</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_drum</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">orc_turbine</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;35&#39;</span><span class="p">)</span>
<span class="n">orc_turb2orc_cond</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_turbine</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_condenser</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;36&#39;</span><span class="p">)</span>
<span class="n">orc_cond2orc_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_condenser</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;37&#39;</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span>
    <span class="n">orc_pump2orc_cc</span><span class="p">,</span> <span class="n">orc_cc2orc_preheater</span><span class="p">,</span> <span class="n">orc_preheat2orc_drum</span><span class="p">,</span> <span class="n">orc_drum2orc_eva</span><span class="p">,</span>
    <span class="n">orc_eva2orc_drum</span><span class="p">,</span> <span class="n">orc_drum2orc_turb</span><span class="p">,</span> <span class="n">orc_turb2orc_cond</span><span class="p">,</span> <span class="n">orc_cond2orc_pump</span>
    <span class="p">)</span>

<span class="c1"># Condenser coolant strand</span>
<span class="n">cool_source2orc_cond</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">cool_source</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_condenser</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;51&#39;</span><span class="p">)</span>
<span class="n">orc_cond2cool_sink</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_condenser</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">cool_sink</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;52&#39;</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span><span class="n">cool_source2orc_cond</span><span class="p">,</span> <span class="n">orc_cond2cool_sink</span><span class="p">)</span>

<span class="c1"># Geothermal liquid strand</span>
<span class="n">liquid_source2orc_eva</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">liquid_source</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;17&#39;</span><span class="p">)</span>
<span class="n">orc_eva2orc_preheat</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;18&#39;</span><span class="p">)</span>
<span class="n">orc_preheat2geo_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;19&#39;</span><span class="p">)</span>
<span class="n">geo_pump2geo_sink1</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_sink1</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;21&#39;</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span>
    <span class="n">liquid_source2orc_eva</span><span class="p">,</span> <span class="n">orc_eva2orc_preheat</span><span class="p">,</span> <span class="n">orc_preheat2geo_pump</span><span class="p">,</span> <span class="n">geo_pump2geo_sink1</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Second Step</strong>:  Set the process parameters and starting values. After that solve orc cycle with starting and final values</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">CoolProp.CoolProp</span> <span class="kn">import</span> <span class="n">PropsSI</span> <span class="k">as</span> <span class="n">PSI</span>

<span class="c1"># Parametrization</span>
<span class="c1"># Component parameters</span>
<span class="n">orc_turbine</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

<span class="n">orc_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">geo_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">orc_preheater</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pr2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">orc_evaporator</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">orc_condenser</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pr2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Connection parameter</span>
<span class="c1"># ORC</span>
<span class="n">p_orc_condenser</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mi">35</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-5</span>
<span class="n">orc_turb2orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_orc_condenser</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_orc</span><span class="p">)</span>

<span class="n">p_orc_evaporator</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mi">150</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-5</span>
<span class="n">orc_eva2orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_orc_evaporator</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">orc_preheat2orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">Td_bp</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Geothermal liquid strand</span>
<span class="n">liquid_source2orc_eva</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="mf">0.55</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">10.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_water</span><span class="p">)</span>
<span class="n">geo_pump2geo_sink1</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Condenser coolant strand</span>
<span class="n">cool_source2orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.013</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_air</span><span class="p">)</span>
<span class="n">orc_cond2cool_sink</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Initial solve with starting values</span>
<span class="n">nw</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">)</span>

<span class="c1"># Final solve</span>
<span class="n">orc_eva2orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">orc_evaporator</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">ttd_l</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">orc_turb2orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">orc_condenser</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">ttd_u</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:Invalid value for ttd_l: ttd_l = -19.956346618682346 below minimum value (0) at component ORC Evaporator.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:Invalid value for ttd_u: ttd_u = -14.956346618681891 below minimum value (0) at component ORC Preheater.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 3.06e+08 | 3.32e+05 | 7.93e+06 | 5.75e+06 | 0.00e+00
2	| 6.26e+09 | 2.83e+06 | 3.09e+06 | 1.30e+08 | 0.00e+00
3	| 3.69e+10 | 1.96e+06 | 1.27e+06 | 2.83e+07 | 0.00e+00
4	| 1.78e+10 | 4.13e+05 | 5.57e+05 | 1.15e+06 | 0.00e+00
5	| 3.18e+09 | 1.49e+05 | 2.13e+05 | 5.90e+06 | 0.00e+00
6	| 1.45e+08 | 3.21e+03 | 5.50e+04 | 1.43e+05 | 0.00e+00
7	| 2.85e+05 | 3.83e+00 | 3.30e-10 | 3.04e+02 | 0.00e+00
8	| 5.93e-01 | 7.20e-05 | 3.30e-10 | 6.11e-04 | 0.00e+00
9	| 1.04e-07 | 1.53e-09 | 3.30e-10 | 9.76e-08 | 0.00e+00
--------+----------+----------+----------+----------+---------
Total iterations: 9, Calculation time: 0.1 s, Iterations per second: 114.72
iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 3.00e+01 | 7.49e+02 | 6.23e+06 | 4.63e+05 | 0.00e+00
2	| 1.46e+07 | 3.50e+02 | 1.93e+06 | 5.16e+04 | 0.00e+00
3	| 2.39e+06 | 2.79e+02 | 3.88e+05 | 1.47e+04 | 0.00e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4	| 1.42e+05 | 6.76e+01 | 2.06e+04 | 6.34e+03 | 0.00e+00
5	| 6.85e+03 | 1.06e+00 | 9.05e+01 | 8.46e+01 | 0.00e+00
6	| 1.16e+00 | 1.27e-04 | 4.49e-02 | 1.43e-02 | 0.00e+00
7	| 7.24e-07 | 1.07e-05 | 7.90e-03 | 2.06e-03 | 0.00e+00
--------+----------+----------+----------+----------+---------
Total iterations: 7, Calculation time: 0.1 s, Iterations per second: 75.35
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="proposed-solution-1-1">
<h2>Proposed solution 1.1<a class="headerlink" href="#proposed-solution-1-1" title="Permalink to this heading">#</a></h2>
<section id="geothermal-combined-heat-and-power-plant">
<h3>Geothermal combined heat and power plant<a class="headerlink" href="#geothermal-combined-heat-and-power-plant" title="Permalink to this heading">#</a></h3>
<p><strong>First Step</strong>: Build the geothermal steam strand for the chp process design</p>
<p>Be sure this one runs standalone first!</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Geothermal steam strand with district heating system</span>
<span class="c1"># Components</span>
<span class="n">steam_turbine</span> <span class="o">=</span> <span class="n">Turbine</span><span class="p">(</span><span class="s1">&#39;Steam Turbine&#39;</span><span class="p">)</span>
<span class="n">dh_condenser</span> <span class="o">=</span> <span class="n">Condenser</span><span class="p">(</span><span class="s1">&#39;District Heating Condenser&#39;</span><span class="p">)</span>
<span class="n">dh_preheater</span> <span class="o">=</span> <span class="n">HeatExchanger</span><span class="p">(</span><span class="s1">&#39;District Heating Preheater&#39;</span><span class="p">)</span>
<span class="n">dh_cc</span> <span class="o">=</span> <span class="n">CycleCloser</span><span class="p">(</span><span class="s1">&#39;District Heating Cycle Closer&#39;</span><span class="p">)</span>
<span class="n">dh_pump</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="s1">&#39;District Heating Pump&#39;</span><span class="p">)</span>
<span class="n">dh_heatsink</span> <span class="o">=</span> <span class="n">HeatExchangerSimple</span><span class="p">(</span><span class="s1">&#39;District Heating Consumer&#39;</span><span class="p">)</span>
<span class="n">steam_pump</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="s1">&#39;Steam Pump&#39;</span><span class="p">)</span>

<span class="c1"># Auxiliary source and sink</span>
<span class="n">steam_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;Steam Sep Source&#39;</span><span class="p">)</span>
<span class="n">geo_sink2</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;Geothermal Sink2&#39;</span><span class="p">)</span>

<span class="c1"># Connection</span>
<span class="c1"># Geothermal steam strand</span>
<span class="n">steam_source2steam_turb</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">steam_source</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">steam_turbine</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
<span class="n">steam_turb2dh_cond</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">steam_turbine</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">dh_condenser</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;13&#39;</span><span class="p">)</span>
<span class="n">dh_cond2dh_preheat</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">dh_condenser</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">dh_preheater</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;14&#39;</span><span class="p">)</span>
<span class="n">dh_preheat2steam_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">dh_preheater</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">steam_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;15&#39;</span><span class="p">)</span>
<span class="n">steam_pump2geo_sink2</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">steam_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_sink2</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span>
    <span class="n">steam_source2steam_turb</span><span class="p">,</span> <span class="n">steam_turb2dh_cond</span><span class="p">,</span> <span class="n">dh_cond2dh_preheat</span><span class="p">,</span>
    <span class="n">dh_preheat2steam_pump</span><span class="p">,</span> <span class="n">steam_pump2geo_sink2</span>
    <span class="p">)</span>

<span class="c1"># District heating system</span>
<span class="n">dh_heatsink2dh_cc</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">dh_heatsink</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">dh_cc</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;60&#39;</span><span class="p">)</span>
<span class="n">dh_cc2dh_preheat</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">dh_cc</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">dh_preheater</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span>
<span class="n">dh_preheat2dh_cond</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">dh_preheater</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">dh_condenser</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;62&#39;</span><span class="p">)</span>
<span class="n">dh_cond2dh_heatsink</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">dh_condenser</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">dh_heatsink</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;63&#39;</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span>
    <span class="n">dh_heatsink2dh_cc</span><span class="p">,</span> <span class="n">dh_cc2dh_preheat</span><span class="p">,</span> <span class="n">dh_preheat2dh_cond</span><span class="p">,</span>
    <span class="n">dh_cond2dh_heatsink</span>
    <span class="p">)</span>

<span class="c1"># Parametrization</span>
<span class="c1"># Components parameter</span>
<span class="n">steam_turbine</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">steam_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">dh_condenser</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pr2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dh_preheater</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pr2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Connection parameter</span>
<span class="c1"># Geothermal steam strand</span>
<span class="n">p_dh_condenser</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mi">105</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-5</span>
<span class="n">steam_turb2dh_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_dh_condenser</span><span class="p">)</span>

<span class="n">steam_source2steam_turb</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">10.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_water</span><span class="p">)</span>
<span class="n">steam_pump2geo_sink2</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># District heating system</span>
<span class="n">dh_cond2dh_heatsink</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_water</span><span class="p">)</span>
<span class="n">dh_heatsink2dh_cc</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s1">&#39;design&#39;</span><span class="p">)</span>

<span class="n">steam_turb2dh_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">dh_condenser</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">ttd_u</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s1">&#39;design&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 9.05e+06 | 1.75e+03 | 7.91e+06 | 1.88e+08 | 0.00e+00
2	| 7.36e+09 | 6.44e+03 | 3.39e+06 | 1.78e+07 | 0.00e+00
3	| 2.13e+10 | 6.65e-03 | 1.29e+06 | 6.34e+06 | 0.00e+00
4	| 5.93e+05 | 4.82e-04 | 5.42e+05 | 8.41e+04 | 0.00e+00
5	| 2.47e+05 | 1.62e-04 | 1.95e+05 | 6.22e+04 | 0.00e+00
6	| 5.02e+04 | 1.24e-06 | 3.53e+04 | 3.41e+04 | 0.00e+00
7	| 3.09e+03 | 1.18e-08 | 8.63e-06 | 3.11e+03 | 0.00e+00
8	| 2.43e-07 | 1.20e-09 | 6.64e-08 | 1.10e-07 | 0.00e+00
--------+----------+----------+----------+----------+---------
Total iterations: 8, Calculation time: 0.1 s, Iterations per second: 60.02
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 8.00e-08 | 1.08e-08 | 7.83e-06 | 6.82e-06 | 0.00e+00
2	| 5.71e-07 | 1.74e-09 | 1.23e-06 | 3.87e-07 | 0.00e+00
3	| 6.75e-08 | 7.34e-09 | 5.39e-06 | 1.67e-06 | 0.00e+00
4	| 1.40e-07 | 9.34e-09 | 6.88e-06 | 2.13e-06 | 0.00e+00
5	| 8.17e-08 | 4.77e-10 | 3.55e-07 | 1.31e-07 | 0.00e+00
--------+----------+----------+----------+----------+---------
Total iterations: 5, Calculation time: 0.1 s, Iterations per second: 55.04
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Second Step</strong>: Connecting ORC with Steam Cycle</p>
<ol class="arabic simple">
<li><p>Build up the merge part</p></li>
<li><p>Build up the seperator part</p></li>
<li><p>Set busses und solve the geothermal combined heat and power plant</p></li>
<li><p>Create and execute <code class="docutils literal notranslate"><span class="pre">ExergyAnalysis</span></code> instance</p></li>
</ol>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tespy.tools</span> <span class="kn">import</span> <span class="n">ExergyAnalysis</span>

<span class="c1"># Components</span>
<span class="c1"># Geothermal heat source with interfaces</span>
<span class="n">geo_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;Geothermal Source&#39;</span><span class="p">)</span>
<span class="n">geo_sink</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;Geothermal Sink&#39;</span><span class="p">)</span>
<span class="n">seperator</span> <span class="o">=</span> <span class="n">DropletSeparator</span><span class="p">(</span><span class="s1">&#39;Seperator&#39;</span><span class="p">)</span>
<span class="n">merge</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="s1">&#39;Merge&#39;</span><span class="p">)</span>

<span class="c1"># Build up the merge part</span>
<span class="c1"># Delete old connections</span>
<span class="n">nw</span><span class="o">.</span><span class="n">del_conns</span><span class="p">(</span><span class="n">geo_pump2geo_sink1</span><span class="p">,</span> <span class="n">steam_pump2geo_sink2</span><span class="p">,</span> <span class="n">orc_preheat2geo_pump</span><span class="p">)</span>

<span class="c1"># Set new connections</span>
<span class="n">steam_pump2merge</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">steam_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">merge</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">)</span>
<span class="n">orc_preheat2merge</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">merge</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;19&#39;</span><span class="p">)</span>
<span class="n">merge2geo_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">merge</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">)</span>
<span class="n">geo_pump2geo_sink</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_sink</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;21&#39;</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span><span class="n">steam_pump2merge</span><span class="p">,</span> <span class="n">orc_preheat2merge</span><span class="p">,</span> <span class="n">merge2geo_pump</span><span class="p">,</span> <span class="n">geo_pump2geo_sink</span><span class="p">)</span>

<span class="c1"># Parametrize new connections</span>
<span class="n">orc_preheat2merge</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>
<span class="n">geo_pump2geo_sink</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">dh_preheat2steam_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>

<span class="c1"># Build up the seperator part</span>
<span class="c1"># Delete old connections</span>
<span class="n">nw</span><span class="o">.</span><span class="n">del_conns</span><span class="p">(</span><span class="n">liquid_source2orc_eva</span><span class="p">,</span> <span class="n">steam_source2steam_turb</span><span class="p">)</span>

<span class="c1"># Set new connections</span>
<span class="n">geo_source2sep</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">geo_source</span><span class="p">,</span><span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">seperator</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;11&#39;</span><span class="p">)</span>
<span class="n">sep2steam_turb</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">seperator</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">steam_turbine</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
<span class="n">sep2orc_eva</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">seperator</span><span class="p">,</span><span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;17&#39;</span><span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span><span class="n">geo_source2sep</span><span class="p">,</span> <span class="n">sep2orc_eva</span><span class="p">,</span> <span class="n">sep2steam_turb</span><span class="p">)</span>

<span class="c1"># Parametrize new connections</span>
<span class="n">geo_source2sep</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">10.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_water</span><span class="p">)</span>
<span class="n">sep2orc_eva</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m0</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="mf">0.55</span><span class="p">)</span>
<span class="n">sep2steam_turb</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m0</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="mf">0.45</span><span class="p">)</span>

<span class="c1"># Busses</span>
<span class="n">heat_in</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;Heat Input&#39;</span><span class="p">)</span>
<span class="n">heat_in</span><span class="o">.</span><span class="n">add_comps</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">geo_source</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">geo_sink</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">}</span>
    <span class="p">)</span>

<span class="n">power_out</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;Power Output&#39;</span><span class="p">)</span>
<span class="n">power_out</span><span class="o">.</span><span class="n">add_comps</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">steam_turbine</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.985</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">orc_turbine</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.985</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">steam_pump</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.975</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">orc_pump</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.975</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.975</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">}</span>
    <span class="p">)</span>

<span class="n">heat_out_dh</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;Heat Output District Heating&#39;</span><span class="p">)</span>
<span class="n">heat_out_dh</span><span class="o">.</span><span class="n">add_comps</span><span class="p">({</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">dh_heatsink</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">})</span>

<span class="n">heat_out_cool</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;Heat Output Cooling&#39;</span><span class="p">)</span>
<span class="n">heat_out_cool</span><span class="o">.</span><span class="n">add_comps</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">cool_source</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">cool_sink</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">}</span>
    <span class="p">)</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_busses</span><span class="p">(</span><span class="n">heat_in</span><span class="p">,</span> <span class="n">power_out</span><span class="p">,</span> <span class="n">heat_out_dh</span><span class="p">,</span> <span class="n">heat_out_cool</span><span class="p">)</span>

<span class="c1"># Solve model</span>
<span class="n">nw</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">)</span>
<span class="n">nw</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>

<span class="c1"># Calculate thermal efficiency</span>
<span class="n">h_in</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mf">10.8e5</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">)</span>
<span class="n">h_out</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="mi">55</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mf">30e5</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">)</span>
<span class="n">delta_H</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">*</span> <span class="p">(</span><span class="n">h_in</span> <span class="o">-</span> <span class="n">h_out</span><span class="p">)</span>
<span class="n">eta_el</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">power_out</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">/</span><span class="n">delta_H</span>
<span class="n">eta_th</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">heat_out_dh</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">/</span><span class="n">delta_H</span>
<span class="n">eta_chp</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">power_out</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">heat_out_dh</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">val</span><span class="p">))</span><span class="o">/</span><span class="n">delta_H</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;eta_el = </span><span class="si">{</span><span class="n">eta_el</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;eta_th = </span><span class="si">{</span><span class="n">eta_th</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;eta_chp = </span><span class="si">{</span><span class="n">eta_chp</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># # Create and execute exergy analysis</span>
<span class="n">dh_heatsink</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">dissipative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ean</span> <span class="o">=</span> <span class="n">ExergyAnalysis</span><span class="p">(</span>
    <span class="n">network</span><span class="o">=</span><span class="n">nw</span><span class="p">,</span> <span class="n">E_F</span><span class="o">=</span><span class="p">[</span><span class="n">heat_in</span><span class="p">],</span> <span class="n">E_P</span><span class="o">=</span><span class="p">[</span><span class="n">heat_out_dh</span><span class="p">,</span> <span class="n">power_out</span><span class="p">],</span> <span class="n">E_L</span><span class="o">=</span><span class="p">[</span><span class="n">heat_out_cool</span><span class="p">])</span>
<span class="n">ean</span><span class="o">.</span><span class="n">analyse</span><span class="p">(</span><span class="n">pamb</span><span class="o">=</span><span class="mf">1.013</span><span class="p">,</span> <span class="n">Tamb</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ean</span><span class="o">.</span><span class="n">print_results</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">connections</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">busses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">epsilon_chp</span> <span class="o">=</span> <span class="n">ean</span><span class="o">.</span><span class="n">network_data</span><span class="p">[</span><span class="s1">&#39;epsilon&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;epsilon_chp = </span><span class="si">{</span><span class="n">epsilon_chp</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 6.48e+08 | 1.56e+03 | 2.87e+06 | 1.45e+07 | 6.43e-14
2	| 1.25e+08 | 1.62e+03 | 4.78e+05 | 3.35e+05 | 3.47e-18
3	| 1.35e+06 | 3.08e+02 | 7.41e+03 | 8.53e+03 | 0.00e+00
4	| 1.95e+04 | 5.73e-01 | 8.80e+02 | 2.48e+02 | 1.61e-16
5	| 7.64e+00 | 5.13e-04 | 2.01e-01 | 4.93e-02 | 1.78e-32
6	| 1.83e-06 | 1.95e-04 | 1.48e-01 | 3.80e-02 | 2.07e-30
--------+----------+----------+----------+----------+---------
Total iterations: 6, Calculation time: 0.2 s, Iterations per second: 39.54
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>##### RESULTS (Pump) #####
+-----------------+----------+----------+----------+
|                 |        P |    eta_s |       pr |
|-----------------+----------+----------+----------|
| ORC Pump        | 1.56e+05 | 8.00e-01 | 2.50e+00 |
| Geothermal Pump | 1.22e+06 | 8.00e-01 | 2.78e+00 |
| Steam Pump      | 2.74e+05 | 8.00e-01 | 8.93e+00 |
+-----------------+----------+----------+----------+
##### RESULTS (Condenser) #####
+----------------------------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+
|                            |         Q |       kA |   td_log |    ttd_u |    ttd_l |      pr1 |      pr2 |    zeta1 |    zeta2 |
|----------------------------+-----------+----------+----------+----------+----------+----------+----------+----------+----------|
| ORC Condenser              | -1.39e+08 | 1.29e+07 | 1.08e+01 | 5.00e+00 | 2.00e+01 | 1.00e+00 | 1.00e+00 | 8.65e-16 | 0.00e+00 |
| District Heating Condenser | -4.50e+08 | 2.30e+07 | 1.96e+01 | 5.00e+00 | 5.02e+01 | 1.00e+00 | 1.00e+00 | 1.12e-15 | 0.00e+00 |
+----------------------------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+
##### RESULTS (HeatExchanger) #####
+----------------------------+-----------+----------+----------+----------+----------+----------+----------+-----------+-----------+
|                            |         Q |       kA |   td_log |    ttd_u |    ttd_l |      pr1 |      pr2 |     zeta1 |     zeta2 |
|----------------------------+-----------+----------+----------+----------+----------+----------+----------+-----------+-----------|
| ORC Evaporator             | -1.26e+08 | 2.89e+06 | 4.35e+01 | 1.17e+02 | 1.00e+01 | 1.00e+00 | 1.00e+00 |  0.00e+00 | -5.44e-15 |
| ORC Preheater              | -2.44e+07 | 1.41e+06 | 1.73e+01 | 1.50e+01 | 1.99e+01 | 1.00e+00 | 1.00e+00 | -1.12e-11 |  0.00e+00 |
| District Heating Preheater | -4.72e+07 | 2.41e+06 | 1.96e+01 | 5.02e+01 | 5.00e+00 | 1.00e+00 | 1.00e+00 | -1.72e-12 |  0.00e+00 |
+----------------------------+-----------+----------+----------+----------+----------+----------+----------+-----------+-----------+
##### RESULTS (CycleCloser) #####
+-------------------------------+------------------+-------------------+
|                               |   mass_deviation |   fluid_deviation |
|-------------------------------+------------------+-------------------|
| ORC Cycle Closer              |         0.00e+00 |          0.00e+00 |
| District Heating Cycle Closer |         0.00e+00 |          0.00e+00 |
+-------------------------------+------------------+-------------------+
##### RESULTS (Turbine) #####
+---------------+-----------+----------+----------+
|               |         P |    eta_s |       pr |
|---------------+-----------+----------+----------|
| ORC Turbine   | -1.13e+07 | 9.00e-01 | 4.00e-01 |
| Steam Turbine | -7.60e+07 | 9.00e-01 | 1.12e-01 |
+---------------+-----------+----------+----------+
##### RESULTS (HeatExchangerSimple) #####
+---------------------------+-----------+----------+----------+-----+-----+------+------+--------+
|                           |         Q |       pr |     zeta |   D |   L |   ks |   kA |   Tamb |
|---------------------------+-----------+----------+----------+-----+-----+------+------+--------|
| District Heating Consumer | -4.98e+08 | 1.00e+00 | 0.00e+00 | nan | nan |  nan |  nan |    nan |
+---------------------------+-----------+----------+----------+-----+-----+------+------+--------+
##### RESULTS (Connection) #####
+----+-----------+-----------+-----------+-----------+
|    |         m |         p |         h |         T |
|----+-----------+-----------+-----------+-----------|
| 30 | 3.895e+02 | 3.224e+00 | 1.698e+01 | 3.511e+01 |
| 31 | 3.895e+02 | 3.224e+00 | 1.698e+01 | 3.511e+01 |
| 32 | 3.895e+02 | 3.224e+00 | 7.951e+01 | 6.116e+01 |
| 33 | 5.787e+02 | 3.224e+00 | 9.198e+01 | 6.616e+01 |
| 34 | 5.787e+02 | 3.224e+00 | 3.095e+02 | 6.616e+01 |
| 35 | 3.895e+02 | 3.224e+00 | 4.027e+02 | 6.616e+01 |
| 36 | 3.895e+02 | 1.290e+00 | 3.737e+02 | 4.594e+01 |
| 37 | 3.895e+02 | 1.290e+00 | 1.658e+01 | 3.500e+01 |
| 51 | 9.215e+03 | 1.013e+00 | 4.144e+02 | 1.500e+01 |
| 52 | 9.215e+03 | 1.013e+00 | 4.295e+02 | 3.000e+01 |
| 18 | 2.750e+02 | 1.080e+01 | 3.197e+02 | 7.616e+01 |
| 13 | 2.250e+02 | 1.209e+00 | 2.442e+03 | 1.050e+02 |
| 14 | 2.250e+02 | 1.209e+00 | 4.403e+02 | 1.050e+02 |
| 15 | 2.250e+02 | 1.209e+00 | 2.303e+02 | 5.500e+01 |
| 60 | 2.374e+03 | 1.000e+01 | 2.102e+02 | 5.000e+01 |
| 61 | 2.374e+03 | 1.000e+01 | 2.102e+02 | 5.000e+01 |
| 62 | 2.374e+03 | 1.000e+01 | 2.301e+02 | 5.476e+01 |
| 63 | 2.374e+03 | 1.000e+01 | 4.198e+02 | 1.000e+02 |
| 16 | 2.250e+02 | 1.080e+01 | 2.316e+02 | 5.510e+01 |
| 19 | 2.750e+02 | 1.080e+01 | 2.312e+02 | 5.500e+01 |
| 20 | 5.000e+02 | 1.080e+01 | 2.313e+02 | 5.504e+01 |
| 21 | 5.000e+02 | 3.000e+01 | 2.338e+02 | 5.523e+01 |
| 11 | 5.000e+02 | 1.080e+01 | 1.679e+03 | 1.832e+02 |
| 17 | 2.750e+02 | 1.080e+01 | 7.774e+02 | 1.832e+02 |
| 12 | 2.250e+02 | 1.080e+01 | 2.780e+03 | 1.832e+02 |
+----+-----------+-----------+-----------+-----------+
##### RESULTS (Bus: Heat Input) #####
+-------------------+-------------------+-------------+--------------+
|                   |   component value |   bus value |   efficiency |
|-------------------+-------------------+-------------+--------------|
| Geothermal Source |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| Geothermal Sink   |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| total             |         0.000e+00 |   0.000e+00 |  nan         |
+-------------------+-------------------+-------------+--------------+
##### RESULTS (Bus: Power Output) #####
+-----------------+-------------------+-------------+--------------+
|                 |   component value |   bus value |   efficiency |
|-----------------+-------------------+-------------+--------------|
| Steam Turbine   |        -7.598e+07 |  -7.409e+07 |    9.751e-01 |
| ORC Turbine     |        -1.130e+07 |  -1.102e+07 |    9.751e-01 |
| Steam Pump      |         2.736e+05 |   2.835e+05 |    9.652e-01 |
| ORC Pump        |         1.557e+05 |   1.613e+05 |    9.652e-01 |
| Geothermal Pump |         1.216e+06 |   1.260e+06 |    9.652e-01 |
| total           |        -8.563e+07 |  -8.340e+07 |  nan         |
+-----------------+-------------------+-------------+--------------+
##### RESULTS (Bus: Heat Output District Heating) #####
+---------------------------+-------------------+-------------+--------------+
|                           |   component value |   bus value |   efficiency |
|---------------------------+-------------------+-------------+--------------|
| District Heating Consumer |        -4.977e+08 |  -4.977e+08 |    1.000e+00 |
| total                     |        -4.977e+08 |  -4.977e+08 |  nan         |
+---------------------------+-------------------+-------------+--------------+
##### RESULTS (Bus: Heat Output Cooling) #####
+----------------+-------------------+-------------+--------------+
|                |   component value |   bus value |   efficiency |
|----------------+-------------------+-------------+--------------|
| Coolant Source |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| Coolant Sink   |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| total          |         0.000e+00 |   0.000e+00 |  nan         |
+----------------+-------------------+-------------+--------------+
eta_el = 0.115
eta_th = 0.688
eta_chp = 0.804
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>##### RESULTS: Aggregation of components and busses #####
+-------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+
|                               |         E_F |         E_P |         E_D |     epsilon |        y_Dk |       y*_Dk |
|-------------------------------+-------------+-------------+-------------+-------------+-------------+-------------|
| District Heating Condenser    |   1.072e+08 |   7.968e+07 |   2.753e+07 |   7.432e-01 |   1.166e-01 |   4.298e-01 |
| ORC Evaporator                |   3.540e+07 |   1.898e+07 |   1.643e+07 |   5.360e-01 |   6.959e-02 |   2.564e-01 |
| Steam Turbine                 |   8.241e+07 |   7.409e+07 |   8.321e+06 |   8.990e-01 |   3.525e-02 |   1.299e-01 |
| ORC Condenser                 |   9.150e+06 |   3.499e+06 |   5.651e+06 |   3.824e-01 |   2.394e-02 |   8.821e-02 |
| District Heating Preheater    |   8.633e+06 |   5.423e+06 |   3.210e+06 |   6.282e-01 |   1.360e-02 |   5.011e-02 |
| ORC Turbine                   |   1.243e+07 |   1.102e+07 |   1.417e+06 |   8.860e-01 |   6.004e-03 |   2.213e-02 |
| ORC Preheater                 |   3.630e+06 |   2.509e+06 |   1.121e+06 |   6.911e-01 |   4.750e-03 |   1.750e-02 |
| Geothermal Pump               |   1.260e+06 |   1.003e+06 |   2.573e+05 |   7.958e-01 |   1.090e-03 |   4.017e-03 |
| Steam Pump                    |   2.835e+05 |   2.256e+05 |   5.789e+04 |   7.958e-01 |   2.452e-04 |   9.037e-04 |
| ORC Pump                      |   1.613e+05 |   1.266e+05 |   3.472e+04 |   7.848e-01 |   1.471e-04 |   5.420e-04 |
| ORC Drum                      |   2.809e+07 |   2.806e+07 |   3.061e+04 |   9.989e-01 |   1.297e-04 |   4.779e-04 |
| Merge                         |   6.043e+03 |   6.036e+03 |   6.334e+00 |   9.990e-01 |   2.683e-08 |   9.888e-08 |
| District Heating Consumer     |   8.510e+07 |   8.510e+07 |   0.000e+00 |   1.000e+00 |   0.000e+00 |   0.000e+00 |
| ORC Cycle Closer              | nan         | nan         | nan         | nan         | nan         | nan         |
| Coolant Source                | nan         | nan         | nan         | nan         | nan         | nan         |
| Coolant Sink                  | nan         | nan         | nan         | nan         | nan         | nan         |
| District Heating Cycle Closer | nan         | nan         | nan         | nan         | nan         | nan         |
| Geothermal Sink               | nan         | nan         | nan         | nan         | nan         | nan         |
| Geothermal Source             | nan         | nan         | nan         | nan         | nan         | nan         |
| Seperator                     | nan         | nan         | nan         | nan         | nan         | nan         |
+-------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+
##### RESULTS: Network exergy analysis #####
+-----------+-----------+-----------+-----------+-----------+
|       E_F |       E_P |       E_D |       E_L |   epsilon |
|-----------+-----------+-----------+-----------+-----------|
| 2.361e+08 | 1.685e+08 | 6.406e+07 | 3.499e+06 | 7.138e-01 |
+-----------+-----------+-----------+-----------+-----------+
epsilon_chp = 0.714
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="proposed-solution-1-2">
<h2>Proposed solution 1.2<a class="headerlink" href="#proposed-solution-1-2" title="Permalink to this heading">#</a></h2>
<section id="geothermal-plant-with-only-power-generation">
<h3>Geothermal plant with only power generation<a class="headerlink" href="#geothermal-plant-with-only-power-generation" title="Permalink to this heading">#</a></h3>
<p><strong>First Step</strong>: Build low pressure ORC for complete condensation operation</p>
<p>Be sure this one runs standalone first!</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nw_el</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">fluids</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">])</span>
<span class="n">nw_el</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T_unit</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">p_unit</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">h_unit</span><span class="o">=</span><span class="s1">&#39;kJ / kg&#39;</span><span class="p">)</span>

<span class="n">flu_vec_orc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">flu_vec_water</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">flu_vec_air</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="c1"># Components</span>
<span class="c1"># Low pressure ORC</span>
<span class="n">lp_orc_cc</span> <span class="o">=</span> <span class="n">CycleCloser</span><span class="p">(</span><span class="s1">&#39;LP ORC Cycle Closer&#39;</span><span class="p">)</span>
<span class="n">lp_orc_preheater</span> <span class="o">=</span> <span class="n">HeatExchanger</span><span class="p">(</span><span class="s1">&#39;LP ORC Preheater&#39;</span><span class="p">)</span>
<span class="n">lp_orc_drum</span> <span class="o">=</span> <span class="n">Drum</span><span class="p">(</span><span class="s1">&#39;LP ORC Drum&#39;</span><span class="p">)</span>
<span class="n">lp_orc_evaporator</span> <span class="o">=</span> <span class="n">HeatExchanger</span><span class="p">(</span><span class="s1">&#39;LP ORC Evaporator&#39;</span><span class="p">)</span>
<span class="n">lp_orc_turbine</span> <span class="o">=</span> <span class="n">Turbine</span><span class="p">(</span><span class="s1">&#39;LP ORC Turbine&#39;</span><span class="p">)</span>
<span class="n">lp_orc_condenser</span> <span class="o">=</span> <span class="n">Condenser</span><span class="p">(</span><span class="s1">&#39;LP ORC Condenser&#39;</span><span class="p">)</span>
<span class="n">lp_orc_pump</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="s1">&#39;LP ORC Pump&#39;</span><span class="p">)</span>

<span class="c1"># Condenser coolant cycle</span>
<span class="n">lp_cool_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;LP Coolant Source&#39;</span><span class="p">)</span>
<span class="n">lp_cool_sink</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;LP Coolant Sink&#39;</span><span class="p">)</span>

<span class="c1"># Geothermal steam Cycle</span>
<span class="n">steam_turbine</span> <span class="o">=</span> <span class="n">Turbine</span><span class="p">(</span><span class="s1">&#39;Steam Turbine&#39;</span><span class="p">)</span>
<span class="n">steam_pump</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="s1">&#39;Steam Pump&#39;</span><span class="p">)</span>

<span class="c1"># Auxiliary source and sink</span>
<span class="n">steam_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;Steam Sep Source&#39;</span><span class="p">)</span>
<span class="n">geo_sink2</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;Geothermal Sink2&#39;</span><span class="p">)</span>

<span class="c1"># Connections</span>
<span class="c1"># Low pressure ORC</span>
<span class="n">lp_orc_pump2lp_orc_cc</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">lp_orc_cc</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;40&#39;</span><span class="p">)</span>
<span class="n">lp_orc_cc2lp_orc_preheater</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_cc</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">lp_orc_preheater</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;41&#39;</span><span class="p">)</span>
<span class="n">lp_orc_preheat2lp_orc_drum</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_preheater</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">lp_orc_drum</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;42&#39;</span><span class="p">)</span>
<span class="n">lp_orc_drum2lp_orc_eva</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_drum</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">lp_orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;43&#39;</span><span class="p">)</span>
<span class="n">lp_orc_eva2lp_orc_drum</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">lp_orc_drum</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;44&#39;</span><span class="p">)</span>
<span class="n">lp_orc_drum2lp_orc_turb</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_drum</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">lp_orc_turbine</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">)</span>
<span class="n">lp_orc_turb2lp_orc_cond</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_turbine</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">lp_orc_condenser</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;46&#39;</span><span class="p">)</span>
<span class="n">lp_orc_cond2lp_orc_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_condenser</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">lp_orc_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;47&#39;</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span>
    <span class="n">lp_orc_pump2lp_orc_cc</span><span class="p">,</span> <span class="n">lp_orc_cc2lp_orc_preheater</span><span class="p">,</span> <span class="n">lp_orc_preheat2lp_orc_drum</span><span class="p">,</span> 
    <span class="n">lp_orc_drum2lp_orc_eva</span><span class="p">,</span> <span class="n">lp_orc_eva2lp_orc_drum</span><span class="p">,</span> <span class="n">lp_orc_drum2lp_orc_turb</span><span class="p">,</span> 
    <span class="n">lp_orc_turb2lp_orc_cond</span><span class="p">,</span> <span class="n">lp_orc_cond2lp_orc_pump</span>
    <span class="p">)</span>

<span class="c1"># Condenser coolant cycle</span>
<span class="n">lp_cool_source2lp_orc_cond</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_cool_source</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">lp_orc_condenser</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;71&#39;</span><span class="p">)</span>
<span class="n">lp_orc_cond2lp_cool_sink</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_condenser</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">lp_cool_sink</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;72&#39;</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span><span class="n">lp_cool_source2lp_orc_cond</span><span class="p">,</span> <span class="n">lp_orc_cond2lp_cool_sink</span><span class="p">)</span>

<span class="c1"># Steam cyclye</span>
<span class="n">steam_source2steam_turb</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">steam_source</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">steam_turbine</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
<span class="n">steam_turb2lp_orc_eva</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">steam_turbine</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">lp_orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;13&#39;</span><span class="p">)</span>
<span class="n">lp_orc_eva2lp_orc_preheat</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">lp_orc_preheater</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;14&#39;</span><span class="p">)</span>
<span class="n">lp_orc_preheat2steam_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">lp_orc_preheater</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">steam_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;15&#39;</span><span class="p">)</span>
<span class="n">steam_pump2geo_sink2</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">steam_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_sink2</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span>
    <span class="n">steam_source2steam_turb</span><span class="p">,</span> <span class="n">steam_turb2lp_orc_eva</span><span class="p">,</span> <span class="n">lp_orc_eva2lp_orc_preheat</span><span class="p">,</span>
    <span class="n">lp_orc_preheat2steam_pump</span><span class="p">,</span> <span class="n">steam_pump2geo_sink2</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Second Step</strong>: Set the process parameters and starting values. After that solve orc cycle with starting and final values</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">CoolProp.CoolProp</span> <span class="kn">import</span> <span class="n">PropsSI</span> <span class="k">as</span> <span class="n">PSI</span>

<span class="c1"># Parametrization</span>
<span class="c1"># Component parameters</span>
<span class="n">steam_turbine</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">lp_orc_turbine</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

<span class="n">lp_orc_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">steam_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">lp_orc_preheater</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pr2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_orc_evaporator</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_orc_condenser</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pr2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Connection parameter</span>
<span class="c1"># Low pressure ORC</span>
<span class="n">p_lp_orc_condenser</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span>  <span class="mi">35</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-5</span>
<span class="n">lp_orc_turb2lp_orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_lp_orc_condenser</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_orc</span><span class="p">)</span>

<span class="n">p_lp_orc_evaporator</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mi">100</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-5</span>
<span class="n">lp_orc_eva2lp_orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_lp_orc_evaporator</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">lp_orc_preheat2lp_orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">Td_bp</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Geothermal steam cyclye</span>
<span class="n">steam_source2steam_turb</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">10.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_water</span><span class="p">)</span>
<span class="n">p_steam_lp_orc_evap</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span>  <span class="mi">120</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-5</span>
<span class="n">steam_turb2lp_orc_eva</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_steam_lp_orc_evap</span><span class="p">)</span>
<span class="c1"># lp_orc_eva2lp_orc_preheat.set_attr(x0=0)</span>
<span class="n">steam_pump2geo_sink2</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Condenser coolant cycle</span>
<span class="n">lp_cool_source2lp_orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.013</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_air</span><span class="p">)</span>
<span class="n">lp_orc_cond2lp_cool_sink</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Initial solve with starting values</span>
<span class="n">nw_el</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">)</span>

<span class="c1"># Final solve</span>
<span class="n">lp_orc_eva2lp_orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">lp_orc_evaporator</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">ttd_l</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">lp_orc_turb2lp_orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">lp_orc_condenser</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">ttd_u</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:Invalid value for ttd_l: ttd_l = -2.2147912939904586 below minimum value (0) at component LP ORC Evaporator.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 1.08e+07 | 1.64e+05 | 9.41e+06 | 3.51e+08 | 0.00e+00
2	| 1.77e+09 | 1.63e+05 | 4.29e+06 | 1.59e+06 | 0.00e+00
3	| 4.09e+08 | 8.38e+03 | 1.78e+06 | 1.18e+06 | 0.00e+00
4	| 7.52e+07 | 4.99e+02 | 7.12e+05 | 3.96e+05 | 0.00e+00
5	| 4.90e+06 | 9.32e+01 | 2.42e+05 | 3.01e+04 | 0.00e+00
6	| 5.79e+05 | 9.83e+00 | 5.50e+04 | 1.88e+03 | 0.00e+00
7	| 2.66e+02 | 8.46e-02 | 1.46e-11 | 1.47e+00 | 0.00e+00
8	| 1.03e-02 | 9.80e-07 | 1.46e-11 | 6.17e-07 | 0.00e+00
9	| 7.91e-08 | 6.45e-10 | 1.46e-11 | 2.58e-08 | 0.00e+00
--------+----------+----------+----------+----------+---------
Total iterations: 9, Calculation time: 0.1 s, Iterations per second: 110.66
iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 1.22e+01 | 4.61e+02 | 1.22e+06 | 1.74e+05 | 0.00e+00
2	| 2.92e+06 | 2.03e+02 | 1.67e+05 | 2.59e+04 | 0.00e+00
3	| 8.82e+04 | 2.01e+01 | 2.24e+03 | 2.61e+03 | 0.00e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4	| 9.97e+02 | 1.09e-01 | 4.98e+01 | 1.60e+01 | 0.00e+00
5	| 3.32e-02 | 9.21e-07 | 1.75e-03 | 1.33e-04 | 0.00e+00
6	| 5.69e-07 | 2.58e-06 | 2.18e-03 | 6.04e-04 | 0.00e+00
--------+----------+----------+----------+----------+---------
Total iterations: 6, Calculation time: 0.1 s, Iterations per second: 74.43
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Third Step</strong>: <em>Identically</em> build the ORC as in <a class="reference internal" href="#orc-proposed-solution-1-label"><span class="std std-ref">Proposed solution 1</span></a></p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Components</span>
<span class="c1"># ORC</span>
<span class="n">orc_cc</span> <span class="o">=</span> <span class="n">CycleCloser</span><span class="p">(</span><span class="s1">&#39;ORC Cycle Closer&#39;</span><span class="p">)</span>
<span class="n">orc_preheater</span> <span class="o">=</span> <span class="n">HeatExchanger</span><span class="p">(</span><span class="s1">&#39;ORC Preheater&#39;</span><span class="p">)</span>
<span class="n">orc_drum</span> <span class="o">=</span> <span class="n">Drum</span><span class="p">(</span><span class="s1">&#39;ORC Drum&#39;</span><span class="p">)</span>
<span class="n">orc_evaporator</span> <span class="o">=</span> <span class="n">HeatExchanger</span><span class="p">(</span><span class="s1">&#39;ORC Evaporator&#39;</span><span class="p">)</span>
<span class="n">orc_turbine</span> <span class="o">=</span> <span class="n">Turbine</span><span class="p">(</span><span class="s1">&#39;ORC Turbine&#39;</span><span class="p">)</span>
<span class="n">orc_condenser</span> <span class="o">=</span> <span class="n">Condenser</span><span class="p">(</span><span class="s1">&#39;ORC Condenser&#39;</span><span class="p">)</span>
<span class="n">orc_pump</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="s1">&#39;ORC Pump&#39;</span><span class="p">)</span>

<span class="c1"># Condenser coolant cycle</span>
<span class="n">cool_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;Coolant Source&#39;</span><span class="p">)</span>
<span class="n">cool_sink</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;Coolant Sink&#39;</span><span class="p">)</span>

<span class="c1"># Auxiliary source and sink</span>
<span class="n">liquid_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;Liquid Sep Source&#39;</span><span class="p">)</span>
<span class="n">geo_pump</span> <span class="o">=</span> <span class="n">Pump</span><span class="p">(</span><span class="s1">&#39;Geothermal Pump&#39;</span><span class="p">)</span>
<span class="n">geo_sink1</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;Geothermal Sink1&#39;</span><span class="p">)</span>

<span class="c1"># Connections</span>
<span class="c1"># ORC</span>
<span class="n">orc_pump2orc_cc</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_cc</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;30&#39;</span><span class="p">)</span>
<span class="n">orc_cc2orc_preheater</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_cc</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;31&#39;</span><span class="p">)</span>
<span class="n">orc_preheat2orc_drum</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">orc_drum</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;32&#39;</span><span class="p">)</span>
<span class="n">orc_drum2orc_eva</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_drum</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;33&#39;</span><span class="p">)</span>
<span class="n">orc_eva2orc_drum</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">orc_drum</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;34&#39;</span><span class="p">)</span>
<span class="n">orc_drum2orc_turb</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_drum</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">orc_turbine</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;35&#39;</span><span class="p">)</span>
<span class="n">orc_turb2orc_cond</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_turbine</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_condenser</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;36&#39;</span><span class="p">)</span>
<span class="n">orc_cond2orc_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_condenser</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;37&#39;</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span>
    <span class="n">orc_pump2orc_cc</span><span class="p">,</span> <span class="n">orc_cc2orc_preheater</span><span class="p">,</span> <span class="n">orc_preheat2orc_drum</span><span class="p">,</span> <span class="n">orc_drum2orc_eva</span><span class="p">,</span>
    <span class="n">orc_eva2orc_drum</span><span class="p">,</span> <span class="n">orc_drum2orc_turb</span><span class="p">,</span> <span class="n">orc_turb2orc_cond</span><span class="p">,</span> <span class="n">orc_cond2orc_pump</span>
    <span class="p">)</span>

<span class="c1"># Condenser coolant cycle</span>
<span class="n">cool_source2orc_cond</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">cool_source</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_condenser</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;51&#39;</span><span class="p">)</span>
<span class="n">orc_cond2cool_sink</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_condenser</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">cool_sink</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;52&#39;</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span><span class="n">cool_source2orc_cond</span><span class="p">,</span> <span class="n">orc_cond2cool_sink</span><span class="p">)</span>

<span class="c1"># Geothermal liquid cyclye</span>
<span class="n">liquid_source2orc_eva</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">liquid_source</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;17&#39;</span><span class="p">)</span>
<span class="n">orc_eva2orc_preheat</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;18&#39;</span><span class="p">)</span>
<span class="n">orc_preheat2geo_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;19&#39;</span><span class="p">)</span>
<span class="n">geo_pump2geo_sink1</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_sink1</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;21&#39;</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span>
    <span class="n">liquid_source2orc_eva</span><span class="p">,</span> <span class="n">orc_eva2orc_preheat</span><span class="p">,</span> <span class="n">orc_preheat2geo_pump</span><span class="p">,</span> <span class="n">geo_pump2geo_sink1</span>
    <span class="p">)</span>

<span class="c1"># Parametrization</span>
<span class="c1"># Component parameters</span>
<span class="n">orc_turbine</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

<span class="n">orc_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">geo_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">eta_s</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">orc_preheater</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pr2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">orc_evaporator</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">orc_condenser</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">pr1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pr2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Connection parameter</span>
<span class="c1"># ORC</span>
<span class="n">p_orc_condenser</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mi">35</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-5</span>
<span class="n">orc_turb2orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_orc_condenser</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_orc</span><span class="p">)</span>

<span class="n">p_orc_evaporator</span> <span class="o">=</span> <span class="n">PSI</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mi">150</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;Isopentane&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-5</span>
<span class="n">orc_eva2orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_orc_evaporator</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">orc_preheat2orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">Td_bp</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Geothermal liquid cyclye</span>
<span class="n">liquid_source2orc_eva</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="mf">0.55</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">10.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_water</span><span class="p">)</span>
<span class="n">geo_pump2geo_sink1</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Condenser coolant cycle</span>
<span class="n">cool_source2orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.013</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_air</span><span class="p">)</span>
<span class="n">orc_cond2cool_sink</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Initial solve with starting values</span>
<span class="n">nw_el</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">)</span>

<span class="c1"># Final solve</span>
<span class="n">orc_eva2orc_drum</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">orc_evaporator</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">ttd_l</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">orc_turb2orc_cond</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">orc_condenser</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">ttd_u</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 3.06e+08 | 3.31e+05 | 7.93e+06 | 5.74e+06 | 0.00e+00
2	| 6.25e+09 | 2.82e+06 | 3.09e+06 | 1.30e+08 | 0.00e+00
3	| 3.68e+10 | 1.95e+06 | 1.27e+06 | 2.82e+07 | 0.00e+00
4	| 1.78e+10 | 4.12e+05 | 5.57e+05 | 1.13e+06 | 0.00e+00
5	| 3.17e+09 | 1.49e+05 | 2.13e+05 | 5.90e+06 | 0.00e+00
6	| 1.44e+08 | 3.20e+03 | 5.50e+04 | 1.43e+05 | 0.00e+00
7	| 2.84e+05 | 3.82e+00 | 5.44e-06 | 3.03e+02 | 0.00e+00
8	| 5.91e-01 | 7.19e-05 | 7.19e-06 | 6.09e-04 | 0.00e+00
9	| 1.35e-07 | 2.51e-09 | 3.11e-08 | 9.53e-08 | 0.00e+00
--------+----------+----------+----------+----------+---------
Total iterations: 9, Calculation time: 0.2 s, Iterations per second: 47.34
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:Invalid value for ttd_l: ttd_l = -19.95634661867399 below minimum value (0) at component ORC Evaporator.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:Invalid value for ttd_u: ttd_u = -14.956346618670693 below minimum value (0) at component ORC Preheater.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 3.00e+01 | 7.49e+02 | 6.23e+06 | 4.63e+05 | 0.00e+00
2	| 1.46e+07 | 3.50e+02 | 1.93e+06 | 5.16e+04 | 0.00e+00
3	| 2.39e+06 | 2.79e+02 | 3.88e+05 | 1.47e+04 | 0.00e+00
4	| 1.42e+05 | 6.76e+01 | 2.06e+04 | 6.34e+03 | 0.00e+00
5	| 6.85e+03 | 1.06e+00 | 9.05e+01 | 8.46e+01 | 0.00e+00
6	| 1.16e+00 | 1.27e-04 | 4.50e-02 | 1.43e-02 | 0.00e+00
7	| 1.27e-07 | 1.07e-05 | 7.90e-03 | 2.06e-03 | 0.00e+00
--------+----------+----------+----------+----------+---------
Total iterations: 7, Calculation time: 0.2 s, Iterations per second: 39.74
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Fourth Step</strong>: Connecting ORC with low pressure ORC</p>
<ol class="arabic simple">
<li><p>Build the merge part</p></li>
<li><p>Build the seperator part</p></li>
<li><p>Set busses und solve the geothermal combined heat and power plant</p></li>
<li><p>Create and execute <code class="docutils literal notranslate"><span class="pre">ExergyAnalysis</span></code> instance</p></li>
</ol>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Components</span>
<span class="c1"># Geothermal heat source with interfaces</span>
<span class="n">geo_source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span><span class="s1">&#39;Geothermal Source&#39;</span><span class="p">)</span>
<span class="n">geo_sink</span> <span class="o">=</span> <span class="n">Sink</span><span class="p">(</span><span class="s1">&#39;Geothermal Sink&#39;</span><span class="p">)</span>
<span class="n">seperator</span> <span class="o">=</span> <span class="n">DropletSeparator</span><span class="p">(</span><span class="s1">&#39;Seperator&#39;</span><span class="p">)</span>
<span class="n">merge</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="s1">&#39;Merge&#39;</span><span class="p">)</span>

<span class="c1"># Build up the merge part</span>
<span class="c1"># Delete old connections</span>
<span class="n">nw_el</span><span class="o">.</span><span class="n">del_conns</span><span class="p">(</span><span class="n">geo_pump2geo_sink1</span><span class="p">,</span> <span class="n">steam_pump2geo_sink2</span><span class="p">,</span> <span class="n">orc_preheat2geo_pump</span><span class="p">)</span>

<span class="c1"># Set new connections</span>
<span class="n">steam_pump2merge</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">steam_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">merge</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">)</span>
<span class="n">orc_preheat2merge</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">orc_preheater</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">merge</span><span class="p">,</span> <span class="s1">&#39;in2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;19&#39;</span><span class="p">)</span>
<span class="n">merge2geo_pump</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">merge</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">)</span>
<span class="n">geo_pump2geo_sink</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">geo_sink</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;21&#39;</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span><span class="n">steam_pump2merge</span><span class="p">,</span> <span class="n">orc_preheat2merge</span><span class="p">,</span> <span class="n">merge2geo_pump</span><span class="p">,</span> <span class="n">geo_pump2geo_sink</span><span class="p">)</span>

<span class="c1"># Parametrize new connections</span>
<span class="n">orc_preheat2merge</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>
<span class="n">geo_pump2geo_sink</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">lp_orc_preheat2steam_pump</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>

<span class="c1"># Build up the seperator part</span>
<span class="c1"># Delete old connections</span>
<span class="n">nw_el</span><span class="o">.</span><span class="n">del_conns</span><span class="p">(</span><span class="n">liquid_source2orc_eva</span><span class="p">,</span> <span class="n">steam_source2steam_turb</span><span class="p">)</span>

<span class="c1"># Set new connections</span>
<span class="n">geo_source2sep</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">geo_source</span><span class="p">,</span><span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">seperator</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;11&#39;</span><span class="p">)</span>
<span class="n">sep2steam_turb</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">seperator</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="n">steam_turbine</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
<span class="n">sep2orc_eva</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">seperator</span><span class="p">,</span><span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="n">orc_evaporator</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;17&#39;</span><span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_conns</span><span class="p">(</span><span class="n">geo_source2sep</span><span class="p">,</span> <span class="n">sep2steam_turb</span><span class="p">,</span> <span class="n">sep2orc_eva</span><span class="p">)</span>

<span class="c1"># Parametrize new connections</span>
<span class="n">geo_source2sep</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">10.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">fluid</span><span class="o">=</span><span class="n">flu_vec_water</span><span class="p">)</span>
<span class="n">sep2orc_eva</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m0</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="mf">0.55</span><span class="p">)</span>
<span class="n">sep2steam_turb</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">m0</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><span class="mf">0.45</span><span class="p">)</span>

<span class="c1"># Busses</span>
<span class="n">heat_in</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;Heat Input&#39;</span><span class="p">)</span>
<span class="n">heat_in</span><span class="o">.</span><span class="n">add_comps</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">geo_source</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">geo_sink</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">}</span>
    <span class="p">)</span>

<span class="n">power_out</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;Power Output&#39;</span><span class="p">)</span>
<span class="n">power_out</span><span class="o">.</span><span class="n">add_comps</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">steam_turbine</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.985</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">orc_turbine</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.985</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">lp_orc_turbine</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.985</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">steam_pump</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.975</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">orc_pump</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.975</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">lp_orc_pump</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.975</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">geo_pump</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mf">0.975</span><span class="o">*</span><span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">}</span>
    <span class="p">)</span>

<span class="n">heat_out_cool</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;Heat Output Cooling&#39;</span><span class="p">)</span>
<span class="n">heat_out_cool</span><span class="o">.</span><span class="n">add_comps</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">cool_source</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">cool_sink</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">lp_cool_source</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">lp_cool_sink</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;component&#39;</span><span class="p">}</span>
    <span class="p">)</span>

<span class="n">nw_el</span><span class="o">.</span><span class="n">add_busses</span><span class="p">(</span><span class="n">heat_in</span><span class="p">,</span> <span class="n">power_out</span><span class="p">,</span> <span class="n">heat_out_cool</span><span class="p">)</span>

<span class="c1"># Solve model</span>
<span class="n">nw_el</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s2">&quot;design&quot;</span><span class="p">)</span>
<span class="n">nw_el</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>

<span class="c1"># Calculate thermal efficiency</span>
<span class="n">eta_el</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">power_out</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">/</span><span class="n">delta_H</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;eta_el = </span><span class="si">{</span><span class="n">eta_el</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">delta_H</span><span class="p">)</span>

<span class="c1"># Create and execute exergy analysis</span>
<span class="n">ean_el</span> <span class="o">=</span> <span class="n">ExergyAnalysis</span><span class="p">(</span>
    <span class="n">network</span><span class="o">=</span><span class="n">nw_el</span><span class="p">,</span> <span class="n">E_F</span><span class="o">=</span><span class="p">[</span><span class="n">heat_in</span><span class="p">],</span> <span class="n">E_P</span><span class="o">=</span><span class="p">[</span><span class="n">power_out</span><span class="p">],</span> <span class="n">E_L</span><span class="o">=</span><span class="p">[</span><span class="n">heat_out_cool</span><span class="p">])</span>
<span class="n">ean_el</span><span class="o">.</span><span class="n">analyse</span><span class="p">(</span><span class="n">pamb</span><span class="o">=</span><span class="mf">1.013</span><span class="p">,</span> <span class="n">Tamb</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ean_el</span><span class="o">.</span><span class="n">print_results</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">connections</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">busses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">epsilon_el</span> <span class="o">=</span> <span class="n">ean_el</span><span class="o">.</span><span class="n">network_data</span><span class="p">[</span><span class="s1">&#39;epsilon&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;epsilon_el = </span><span class="si">{</span><span class="n">epsilon_el</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter	| residual | massflow | pressure | enthalpy | fluid
--------+----------+----------+----------+----------+---------
1	| 6.48e+08 | 2.93e+04 | 5.17e+06 | 1.99e+07 | 8.10e-14
2	| 3.89e+08 | 1.78e+03 | 1.30e+06 | 7.57e+05 | 1.63e-16
3	| 2.41e+07 | 1.82e+03 | 5.80e+06 | 8.95e+05 | 2.88e-19
4	| 2.45e+07 | 7.77e+02 | 1.04e+06 | 1.53e+05 | 1.61e-16
5	| 6.75e+06 | 1.13e+02 | 1.08e+05 | 1.65e+04 | 7.80e-34
6	| 4.65e+04 | 3.49e+00 | 2.10e+03 | 4.14e+01 | 7.80e-34
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:py.warnings:/opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/tespy/components/heat_exchangers/base.py:839: RuntimeWarning: invalid value encountered in scalar divide
  self.td_log.val = ((self.ttd_l.val - self.ttd_u.val) /
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7	| 1.45e+01 | 1.16e-03 | 7.12e-01 | 1.03e-02 | 7.80e-34
8	| 1.20e-05 | 4.16e-05 | 3.50e-02 | 9.40e-03 | 7.80e-34
--------+----------+----------+----------+----------+---------
Total iterations: 8, Calculation time: 0.2 s, Iterations per second: 32.88
##### RESULTS (Turbine) #####
+----------------+-----------+----------+----------+
|                |         P |    eta_s |       pr |
|----------------+-----------+----------+----------|
| LP ORC Turbine | -7.30e+07 | 9.00e-01 | 1.45e-01 |
| Steam Turbine  | -6.04e+07 | 9.00e-01 | 1.84e-01 |
| ORC Turbine    | -1.13e+07 | 9.00e-01 | 4.00e-01 |
+----------------+-----------+----------+----------+
##### RESULTS (HeatExchanger) #####
+-------------------+-----------+------------+------------+----------+----------+----------+----------+-----------+----------+
|                   |         Q |         kA |     td_log |    ttd_u |    ttd_l |      pr1 |      pr2 |     zeta1 |    zeta2 |
|-------------------+-----------+------------+------------+----------+----------+----------+----------+-----------+----------|
| LP ORC Preheater  | -2.00e+08 |   1.16e+07 |   1.72e+01 | 1.50e+01 | 1.96e+01 | 1.00e+00 | 1.00e+00 |  0.00e+00 | 0.00e+00 |
| LP ORC Evaporator | -3.13e+08 | nan        | nan        | 1.00e+01 | 1.00e+01 | 1.00e+00 | 1.00e+00 |  0.00e+00 | 0.00e+00 |
| ORC Evaporator    | -1.26e+08 |   2.89e+06 |   4.35e+01 | 1.17e+02 | 1.00e+01 | 1.00e+00 | 1.00e+00 |  0.00e+00 | 0.00e+00 |
| ORC Preheater     | -2.44e+07 |   1.41e+06 |   1.73e+01 | 1.50e+01 | 1.99e+01 | 1.00e+00 | 1.00e+00 | -7.45e-12 | 0.00e+00 |
+-------------------+-----------+------------+------------+----------+----------+----------+----------+-----------+----------+
##### RESULTS (Pump) #####
+-----------------+----------+----------+----------+
|                 |        P |    eta_s |       pr |
|-----------------+----------+----------+----------|
| LP ORC Pump     | 1.78e+06 | 8.00e-01 | 6.90e+00 |
| Steam Pump      | 2.51e+05 | 8.00e-01 | 5.44e+00 |
| ORC Pump        | 1.56e+05 | 8.00e-01 | 2.50e+00 |
| Geothermal Pump | 1.22e+06 | 8.00e-01 | 2.78e+00 |
+-----------------+----------+----------+----------+
##### RESULTS (Condenser) #####
+------------------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+
|                  |         Q |       kA |   td_log |    ttd_u |    ttd_l |      pr1 |      pr2 |    zeta1 |    zeta2 |
|------------------+-----------+----------+----------+----------+----------+----------+----------+----------+----------|
| LP ORC Condenser | -4.42e+08 | 4.09e+07 | 1.08e+01 | 5.00e+00 | 2.00e+01 | 1.00e+00 | 1.00e+00 | 0.00e+00 | 0.00e+00 |
| ORC Condenser    | -1.39e+08 | 1.29e+07 | 1.08e+01 | 5.00e+00 | 2.00e+01 | 1.00e+00 | 1.00e+00 | 0.00e+00 | 0.00e+00 |
+------------------+-----------+----------+----------+----------+----------+----------+----------+----------+----------+
##### RESULTS (CycleCloser) #####
+---------------------+------------------+-------------------+
|                     |   mass_deviation |   fluid_deviation |
|---------------------+------------------+-------------------|
| LP ORC Cycle Closer |         2.27e-13 |          0.00e+00 |
| ORC Cycle Closer    |         5.68e-14 |          0.00e+00 |
+---------------------+------------------+-------------------+
##### RESULTS (Connection) #####
+----+-----------+-----------+-----------+-----------+
|    |         m |         p |         h |         T |
|----+-----------+-----------+-----------+-----------|
| 40 | 1.133e+03 | 8.905e+00 | 1.815e+01 | 3.542e+01 |
| 41 | 1.133e+03 | 8.905e+00 | 1.815e+01 | 3.542e+01 |
| 42 | 1.133e+03 | 8.905e+00 | 1.947e+02 | 1.050e+02 |
| 43 | 2.388e+03 | 8.905e+00 | 2.088e+02 | 1.100e+02 |
| 44 | 2.388e+03 | 8.905e+00 | 3.399e+02 | 1.100e+02 |
| 45 | 1.133e+03 | 8.905e+00 | 4.710e+02 | 1.100e+02 |
| 46 | 1.133e+03 | 1.290e+00 | 4.066e+02 | 6.387e+01 |
| 47 | 1.133e+03 | 1.290e+00 | 1.658e+01 | 3.500e+01 |
| 71 | 2.929e+04 | 1.013e+00 | 4.144e+02 | 1.500e+01 |
| 72 | 2.929e+04 | 1.013e+00 | 4.295e+02 | 3.000e+01 |
| 13 | 2.250e+02 | 1.987e+00 | 2.511e+03 | 1.200e+02 |
| 14 | 2.250e+02 | 1.987e+00 | 1.120e+03 | 1.200e+02 |
| 15 | 2.250e+02 | 1.987e+00 | 2.304e+02 | 5.500e+01 |
| 30 | 3.895e+02 | 3.224e+00 | 1.698e+01 | 3.511e+01 |
| 31 | 3.895e+02 | 3.224e+00 | 1.698e+01 | 3.511e+01 |
| 32 | 3.895e+02 | 3.224e+00 | 7.951e+01 | 6.116e+01 |
| 33 | 5.787e+02 | 3.224e+00 | 9.198e+01 | 6.616e+01 |
| 34 | 5.787e+02 | 3.224e+00 | 3.095e+02 | 6.616e+01 |
| 35 | 3.895e+02 | 3.224e+00 | 4.027e+02 | 6.616e+01 |
| 36 | 3.895e+02 | 1.290e+00 | 3.737e+02 | 4.594e+01 |
| 37 | 3.895e+02 | 1.290e+00 | 1.658e+01 | 3.500e+01 |
| 51 | 9.215e+03 | 1.013e+00 | 4.144e+02 | 1.500e+01 |
| 52 | 9.215e+03 | 1.013e+00 | 4.295e+02 | 3.000e+01 |
| 18 | 2.750e+02 | 1.080e+01 | 3.197e+02 | 7.616e+01 |
| 16 | 2.250e+02 | 1.080e+01 | 2.315e+02 | 5.509e+01 |
| 19 | 2.750e+02 | 1.080e+01 | 2.312e+02 | 5.500e+01 |
| 20 | 5.000e+02 | 1.080e+01 | 2.313e+02 | 5.504e+01 |
| 21 | 5.000e+02 | 3.000e+01 | 2.338e+02 | 5.523e+01 |
| 11 | 5.000e+02 | 1.080e+01 | 1.679e+03 | 1.832e+02 |
| 12 | 2.250e+02 | 1.080e+01 | 2.780e+03 | 1.832e+02 |
| 17 | 2.750e+02 | 1.080e+01 | 7.774e+02 | 1.832e+02 |
+----+-----------+-----------+-----------+-----------+
##### RESULTS (Bus: Heat Input) #####
+-------------------+-------------------+-------------+--------------+
|                   |   component value |   bus value |   efficiency |
|-------------------+-------------------+-------------+--------------|
| Geothermal Source |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| Geothermal Sink   |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| total             |         0.000e+00 |   0.000e+00 |  nan         |
+-------------------+-------------------+-------------+--------------+
##### RESULTS (Bus: Power Output) #####
+-----------------+-------------------+-------------+--------------+
|                 |   component value |   bus value |   efficiency |
|-----------------+-------------------+-------------+--------------|
| Steam Turbine   |        -6.043e+07 |  -5.893e+07 |    9.751e-01 |
| ORC Turbine     |        -1.130e+07 |  -1.102e+07 |    9.751e-01 |
| LP ORC Turbine  |        -7.298e+07 |  -7.117e+07 |    9.751e-01 |
| Steam Pump      |         2.514e+05 |   2.605e+05 |    9.652e-01 |
| ORC Pump        |         1.557e+05 |   1.613e+05 |    9.652e-01 |
| LP ORC Pump     |         1.783e+06 |   1.847e+06 |    9.652e-01 |
| Geothermal Pump |         1.216e+06 |   1.260e+06 |    9.652e-01 |
| total           |        -1.413e+08 |  -1.376e+08 |  nan         |
+-----------------+-------------------+-------------+--------------+
##### RESULTS (Bus: Heat Output Cooling) #####
+-------------------+-------------------+-------------+--------------+
|                   |   component value |   bus value |   efficiency |
|-------------------+-------------------+-------------+--------------|
| Coolant Source    |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| Coolant Sink      |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| LP Coolant Source |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| LP Coolant Sink   |         0.000e+00 |   0.000e+00 |    1.000e+00 |
| total             |         0.000e+00 |   0.000e+00 |  nan         |
+-------------------+-------------------+-------------+--------------+
eta_el = 0.190
722890679.3083574
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>##### RESULTS: Aggregation of components and busses #####
+---------------------+-------------+-------------+-------------+-------------+-------------+-------------+
|                     |         E_F |         E_P |         E_D |     epsilon |        y_Dk |       y*_Dk |
|---------------------+-------------+-------------+-------------+-------------+-------------+-------------|
| LP ORC Condenser    |   3.116e+07 |   1.112e+07 |   2.004e+07 |   3.569e-01 |   8.489e-02 |   2.390e-01 |
| LP ORC Preheater    |   4.925e+07 |   3.211e+07 |   1.715e+07 |   6.519e-01 |   7.263e-02 |   2.045e-01 |
| ORC Evaporator      |   3.540e+07 |   1.898e+07 |   1.643e+07 |   5.360e-01 |   6.959e-02 |   1.959e-01 |
| LP ORC Turbine      |   7.996e+07 |   7.117e+07 |   8.787e+06 |   8.901e-01 |   3.722e-02 |   1.048e-01 |
| Steam Turbine       |   6.536e+07 |   5.893e+07 |   6.423e+06 |   9.017e-01 |   2.721e-02 |   7.660e-02 |
| LP ORC Evaporator   |   8.363e+07 |   7.764e+07 |   5.990e+06 |   9.284e-01 |   2.537e-02 |   7.143e-02 |
| ORC Condenser       |   9.150e+06 |   3.499e+06 |   5.651e+06 |   3.824e-01 |   2.394e-02 |   6.739e-02 |
| ORC Turbine         |   1.243e+07 |   1.102e+07 |   1.417e+06 |   8.860e-01 |   6.004e-03 |   1.690e-02 |
| ORC Preheater       |   3.630e+06 |   2.509e+06 |   1.121e+06 |   6.911e-01 |   4.750e-03 |   1.337e-02 |
| LP ORC Pump         |   1.847e+06 |   1.450e+06 |   3.972e+05 |   7.849e-01 |   1.683e-03 |   4.737e-03 |
| Geothermal Pump     |   1.260e+06 |   1.003e+06 |   2.573e+05 |   7.958e-01 |   1.090e-03 |   3.069e-03 |
| LP ORC Drum         |   1.956e+08 |   1.955e+08 |   7.863e+04 |   9.996e-01 |   3.331e-04 |   9.378e-04 |
| Steam Pump          |   2.605e+05 |   2.073e+05 |   5.320e+04 |   7.958e-01 |   2.253e-04 |   6.344e-04 |
| ORC Pump            |   1.613e+05 |   1.266e+05 |   3.472e+04 |   7.848e-01 |   1.471e-04 |   4.140e-04 |
| ORC Drum            |   2.809e+07 |   2.806e+07 |   3.061e+04 |   9.989e-01 |   1.297e-04 |   3.651e-04 |
| Merge               |   5.552e+03 |   5.546e+03 |   5.348e+00 |   9.990e-01 |   2.266e-08 |   6.378e-08 |
| LP ORC Cycle Closer | nan         | nan         | nan         | nan         | nan         | nan         |
| LP Coolant Sink     | nan         | nan         | nan         | nan         | nan         | nan         |
| LP Coolant Source   | nan         | nan         | nan         | nan         | nan         | nan         |
| ORC Cycle Closer    | nan         | nan         | nan         | nan         | nan         | nan         |
| Coolant Source      | nan         | nan         | nan         | nan         | nan         | nan         |
| Coolant Sink        | nan         | nan         | nan         | nan         | nan         | nan         |
| Geothermal Sink     | nan         | nan         | nan         | nan         | nan         | nan         |
| Seperator           | nan         | nan         | nan         | nan         | nan         | nan         |
| Geothermal Source   | nan         | nan         | nan         | nan         | nan         | nan         |
+---------------------+-------------+-------------+-------------+-------------+-------------+-------------+
##### RESULTS: Network exergy analysis #####
+-----------+-----------+-----------+-----------+-----------+
|       E_F |       E_P |       E_D |       E_L |   epsilon |
|-----------+-----------+-----------+-----------+-----------|
| 2.361e+08 | 1.376e+08 | 8.385e+07 | 1.462e+07 | 5.828e-01 |
+-----------+-----------+-----------+-----------+-----------+
epsilon_el = 0.583
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="proposed-solution-1-3">
<h2>Proposed solution 1.3<a class="headerlink" href="#proposed-solution-1-3" title="Permalink to this heading">#</a></h2>
<p><strong>First Step</strong>: Evaluate both processes according to Eqs. <a class="reference internal" href="#equation-orc-chp-energy-efficiency">(41)</a> and <a class="reference internal" href="#equation-orc-chp-exergy-efficiency">(42)</a></p>
<div class="dropdown admonition">
<p class="admonition-title">Comparison of energy and exergy efficiency</p>
<table class="table" id="result-comparison">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">Comparison of energy and exergy efficiency</span><a class="headerlink" href="#result-comparison" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Geothermal combined heat and power plant</p></th>
<th class="head"><p>Geothermal plant with only power generation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\eta_{CHP}\)</span></p></td>
<td><p>80.4 %</p></td>
<td><p>19.0 %</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\epsilon_{CHP}\)</span></p></td>
<td><p>0.714</p></td>
<td><p>0.594</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Second Step</strong>: Compare both processes with a grassmann diagramm</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">links</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">ean</span><span class="o">.</span><span class="n">generate_plotly_sankey_input</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
        <span class="n">arrangement</span><span class="o">=</span><span class="s2">&quot;snap&quot;</span><span class="p">,</span>
        <span class="n">node</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">nodes</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">},</span>
        <span class="n">link</span><span class="o">=</span><span class="n">links</span>
        <span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">({</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">800</span><span class="p">})</span>
    <span class="p">)</span>
<span class="c1"># plot(fig, filename=&#39;chp_grassmann&#39;)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">links_el</span><span class="p">,</span> <span class="n">nodes_el</span> <span class="o">=</span> <span class="n">ean_el</span><span class="o">.</span><span class="n">generate_plotly_sankey_input</span><span class="p">()</span>

<span class="n">fig_el</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
        <span class="n">arrangement</span><span class="o">=</span><span class="s2">&quot;snap&quot;</span><span class="p">,</span>
        <span class="n">node</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">nodes_el</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">},</span>
        <span class="n">link</span><span class="o">=</span><span class="n">links_el</span>
        <span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">({</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">800</span><span class="p">})</span>
    <span class="p">)</span>

<span class="n">fig_el</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">links</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">ean</span><span class="o">.</span><span class="n">generate_plotly_sankey_input</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>         <span class="n">arrangement</span><span class="o">=</span><span class="s2">&quot;snap&quot;</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">({</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">800</span><span class="p">})</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;plotly&#39;
</pre></div>
</div>
</div>
</details>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Explanation</p>
<p>Hier könnte ihre Erklärung stehen</p>
</div>
</section>
<section id="lessons-learned">
<h2>Lessons Learned<a class="headerlink" href="#lessons-learned" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Lessons Learned 1</p></li>
<li><p>Lessons Learned 2</p></li>
<li><p>Lessons Learned 3</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./processes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="../abbreveations-symbols.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">List of Abbreveations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-solution-1">Proposed solution 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-solution-1-1">Proposed solution 1.1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geothermal-combined-heat-and-power-plant">Geothermal combined heat and power plant</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-solution-1-2">Proposed solution 1.2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geothermal-plant-with-only-power-generation">Geothermal plant with only power generation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-solution-1-3">Proposed solution 1.3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lessons-learned">Lessons Learned</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Francesco Witte, Malte Fritz, Jonas Freißmann, Mathias Hofmann, Ilja Tuschy, George Tsatsaronis
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>